# Telegram-бот прогнозирования тренда валют  
**Версия 3.0**  



## Описание проекта  

Бот анализирует курсы иностранных валют к рублю и предсказывает, пойдёт курс вверх или вниз на следующий день.  
Исходные данные — официальные курсы Центрального банка РФ.  
Прогнозы формируются с помощью машинного обучения и сопровождаются пояснениями.


## Эволюция проекта  


### Версия 1.0
Первая рабочая версия бота.
Прогноз — искусственная заглушка: направление определяется чётностью текущей минуты (чётная → «вверх», нечётная → «вниз»).
Уверенность подаётся как 65–74%, чтобы имитировать работу модели.
Цель: минимальный MVP, проверка Telegram-интеграции.
Реализовано в одном файле. Не использует внешние данные и машинное обучение.

### Версия 2.0
Первый переход к реальным данным.
Бот подключается к API ЦБ РФ и получает курсы за два последних рабочих дня.
Прогноз строится по простому правилу: если курс сегодня выше, чем вчера — «вверх», иначе — «вниз».
Добавлена обработка ошибок (выходные, таймауты), кнопочная навигация, Markdown-форматирование.
Поддержка трёх валют: USD, EUR, CNY.
Код выделен в логические блоки: получение данных, прогноз, Telegram-обработчики.

### Версия 3.0
Финальная, полноценная версия.
Полностью переработана архитектура: модульность, кэширование, расширяемость.
Основные улучшения:

Поддержка всех валют из ЦБ РФ (более 30), автоматически обновляемый список.
Единая модель машинного обучения для всех валют (ранее — по одной на валюту).
Модель: Random Forest с калибровкой вероятностей, обученная на четырёх признаках — дельта, скользящее среднее, волатильность, RSI.
Перед прогнозом выводится расширенная аналитика: текущий курс, динамика за 1/3/7 дней, уровень волатильности, статус RSI.
Добавлена команда /how с понятным объяснением расчётов — повышает прозрачность и доверие.
Графики генерируются автоматически (PNG), поддерживают как количество дней, так и диапазон дат.
Данные кэшируются локально — снижает нагрузку на API и ускоряет ответ.
Единый, легко читаемый код бота с чёткой структурой и без дублирования.


## Как запустить  

1. Установите зависимости:  
   pip install -r requirements.txt

2. Получите токен у @BotFather и вставьте его в v3_ml_model/bot.py (переменная TOKEN).

3. Запустите бота:  
   cd v3_ml_model  
   python bot.py

4. В Telegram напишите боту:  
   /start  
   /predict USD  

При первом запуске данные закэшируются в папку cache/.


## Команды  

/start — приветствие и описание  
/predict USD — прогноз для доллара (7 дней + ML + график)  
/predict EUR 10 — график евро за 10 дней  
/predict JPY 01.12–18.12 — график за период  
/list — список всех валют  
/how — как считается прогноз?  
/help — краткая справка  


## Прозрачность расчётов  

Все прогнозы сопровождаются пояснением:  
«чёткий сигнал (рост вчера, низкая волатильность)»  
или  
«неопределённо (противоречивые факторы)».  

Команда /how даёт полное описание:  
— откуда берутся данные,  
— какие признаки используются,  
— как работает модель,  
— как интерпретируется уверенность.  

Это делает систему объяснимой и понятной даже без технической подготовки.


## Технологии  

Python 3.9+  
python-telegram-bot  
scikit-learn  
matplotlib  
requests  
joblib  

Данные: API ЦБ РФ (https://cbr.ru/scripts/XML_daily.asp)  
Хостинг локальный

